(function(e){acf.fields.repeater={$el:null,o:{},set:function(t){e.extend(this,t);this.o=acf.helpers.get_atts(this.$el);this.o.row_count=this.$el.find("> table > tbody > tr.row").length;return this},init:function(){var t=this,n=this.$el;this.o.max_rows!=1&&this.$el.find("> table > tbody").unbind("sortable").sortable({items:"> tr.row",handle:"> td.order",helper:acf.helpers.sortable,forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,start:function(t,n){e(document).trigger("acf/sortable_start",n.item);e(document).trigger("acf/sortable_start_repeater",n.item);var r=n.item.children("td").length;n.placeholder.html('<td colspan="'+r+'"></td>')},stop:function(r,i){e(document).trigger("acf/sortable_stop",i.item);e(document).trigger("acf/sortable_stop_repeater",i.item);t.set({$el:n}).render()}});this.render()},render:function(){this.o.row_count=this.$el.find("> table > tbody > tr.row").length;this.$el.find("> table > tbody > tr.row").each(function(t){e(this).children("td.order").html(t+1)});this.o.row_count==0?this.$el.addClass("empty"):this.$el.removeClass("empty");if(this.o.row_count>=this.o.max_rows){this.$el.addClass("disabled");this.$el.find("> .repeater-footer .acf-button").addClass("disabled")}else{this.$el.removeClass("disabled");this.$el.find("> .repeater-footer .acf-button").removeClass("disabled")}},add:function(t){if(this.o.row_count>=this.o.max_rows){alert(acf.l10n.repeater.max.replace("{max}",this.o.max_rows));return!1}var n=acf.helpers.uniqid(),r=this.$el.find("> table > tbody > tr.row-clone").html().replace(/(=["]*[\w-\[\]]*?)(acfcloneindex)/g,"$1"+n),i=e('<tr class="row"></tr>').append(r);t||(t=this.$el.find("> table > tbody > .row-clone"));t.before(i);this.$el.closest("tr").trigger("mouseenter");this.render();e(document).trigger("acf/setup_fields",i);this.$el.closest(".field").removeClass("error")},remove:function(e){var t=this;if(this.o.row_count<=this.o.min_rows){alert(acf.l10n.repeater.min.replace("{min}",this.o.min_rows));return!1}e.addClass("acf-remove-item");setTimeout(function(){e.remove();t.$el.closest("tr").trigger("mouseenter");t.render()},400)}};e(document).on("acf/setup_fields",function(t,n){e(n).find(".repeater").each(function(){acf.fields.repeater.set({$el:e(this)}).init()})});e(document).on("click",".repeater .repeater-footer .add-row-end",function(t){t.preventDefault();acf.fields.repeater.set({$el:e(this).closest(".repeater")}).add(!1);e(this).blur()});e(document).on("click",".repeater td.remove .add-row-before",function(t){t.preventDefault();acf.fields.repeater.set({$el:e(this).closest(".repeater")}).add(e(this).closest("tr"));e(this).blur()});e(document).on("click",".repeater td.remove .acf-button-remove",function(t){t.preventDefault();acf.fields.repeater.set({$el:e(this).closest(".repeater")}).remove(e(this).closest("tr"));e(this).blur()});e(document).on("mouseenter",".repeater tr.row",function(t){var n=e(this).find("> td.remove > a.acf-button-add"),r=n.parent().height()/2+9;n.css("margin-top","-"+r+"px")});e(document).on("acf/conditional_logic/show acf/conditional_logic/hide",function(e,t,n){t.closest("tr.row").trigger("mouseenter")})})(jQuery);